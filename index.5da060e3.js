!function(){function t(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function e(e,r){if(e){if("string"==typeof e)return t(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return t(e,r)}}function r(r){return function(e){if(Array.isArray(e))return t(e)}(r)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(r)||e(r)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var n=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],a=new(function(){var t;function a(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n;!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,a),this.initialStateSaved=JSON.parse(JSON.stringify(t)),n=t,this.score=0,this.status="idle",this.gameStarted=!1,this.boardChanged=!1}return t=[{key:"isMovePossibleHorisontally",value:function(t){return this.hasSameNeighbours(t)}},{key:"isMovePossibleVertically",value:function(t){var e=this.rotateArrayClockwise(t);return this.hasSameNeighbours(e)}},{key:"hasSameNeighbours",value:function(t){var e=!1,r=!0,n=!1,a=void 0;try{for(var o,i=Array.from(t)[Symbol.iterator]();!(r=(o=i.next()).done);r=!0){for(var l=o.value,s=l.filter(function(t){return t>0}),u=1;u<s.length;u++)s[u]===s[u-1]&&(e=!0);l.some(function(t){return 0===t})&&(e=!0)}}catch(t){n=!0,a=t}finally{try{r||null==i.return||i.return()}finally{if(n)throw a}}return e}},{key:"rotateArrayClockwise",value:function(t){return t[0].map(function(e,r){return t.map(function(t){return t[r]}).reverse()})}},{key:"rotateArrayCounterClockwise",value:function(t){return t[0].map(function(e,r){return t.map(function(t){return t[r]})}).reverse()}},{key:"addRandom",value:function(){for(var t=[],r=[2,2,2,2,2,2,2,2,2,4],a=0;a<4;a++)for(var o=0;o<4;o++)0===n[a][o]&&t.push([a,o]);if(0!==t.length){var i,l=1===t.length?0:Math.floor(Math.random()*t.length),s=Math.floor(Math.random()*r.length),u=function(t){if(Array.isArray(t))return t}(i=t[l])||function(t,e){var r,n,a=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=a){var o=[],i=!0,l=!1;try{for(a=a.call(t);!(i=(r=a.next()).done)&&(o.push(r.value),2!==o.length);i=!0);}catch(t){l=!0,n=t}finally{try{i||null==a.return||a.return()}finally{if(l)throw n}}return o}}(i,2)||e(i,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),f=u[0],c=u[1];n[f][c]=r[s]}}},{key:"moveCells",value:function(t){var e=[],a="up"===t?this.rotateArrayCounterClockwise(n):"down"===t?this.rotateArrayClockwise(n):r(n),o=!0,i=!1,l=void 0;try{for(var s,u=a[Symbol.iterator]();!(o=(s=u.next()).done);o=!0){var f=s.value,c=r(f).filter(function(t){return t>0});if("left"===t){var d=this.mergeRowLeft(c);e.push(d)}if("right"===t){var y=this.mergeRowLeft(c.reverse());e.push(y.reverse())}if("up"===t){var h=this.mergeRowLeft(c);e.push(h)}if("down"===t){var v=this.mergeRowLeft(c);e.push(v)}}}catch(t){i=!0,l=t}finally{try{o||null==u.return||u.return()}finally{if(i)throw l}}var m="up"===t?this.rotateArrayClockwise(e):"down"===t?this.rotateArrayCounterClockwise(e):e;return this.boardChanged=JSON.stringify(n)!==JSON.stringify(m),n=m,m}},{key:"mergeRowLeft",value:function(t){for(var e=[0,0,0,0],r=0;r<t.length;)t[r]===t[r+1]?(e[r]=t[r]+t[r+1],this.score+=e[r],t.splice(r,1),t.push(0)):e[r]=t[r],r+=1;return e.length=4,e}},{key:"moveLeft",value:function(){this.gameStarted&&(this.moveCells("left"),this.boardChanged&&this.addRandom())}},{key:"moveRight",value:function(){this.gameStarted&&(this.moveCells("right"),this.boardChanged&&this.addRandom())}},{key:"moveUp",value:function(){this.gameStarted&&(this.moveCells("up"),this.boardChanged&&this.addRandom())}},{key:"moveDown",value:function(){this.gameStarted&&(this.moveCells("down"),this.boardChanged&&this.addRandom())}},{key:"getScore",value:function(){return this.score}},{key:"getState",value:function(){return n}},{key:"getStatus",value:function(){return n.flat().some(function(t){return 2048===t})?"win":this.isMovePossibleHorisontally(n)||this.isMovePossibleVertically(n)?this.status:"lose"}},{key:"start",value:function(){this.gameStarted=!0,this.addRandom(),this.addRandom(),this.status="playing"}},{key:"restart",value:function(){this.initialStateSaved.flat().every(function(t){return 0===t})?(n=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],this.addRandom(),this.addRandom()):n=r(this.initialStateSaved),this.gameStarted=!0,this.score=0,this.status="idle"}}],function(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}(a.prototype,t),a}()),o=document.querySelector(".start"),i=document.querySelector(".game-score"),l=document.querySelector(".message-lose"),s=document.querySelector(".message-win"),u=document.querySelector(".message.message-start");function f(){Array.from(document.querySelector(".game-field tbody").getElementsByClassName("field-row")).forEach(function(t,e){var r=t.getElementsByClassName("field-cell");Array.from(r).forEach(function(t){t.textContent=""});var n=a.getState();Array.from(r).forEach(function(t,r){if(0!==n[e][r]){t.textContent=n[e][r];var a=!0,o=!1,i=void 0;try{for(var l,s=t.classList[Symbol.iterator]();!(a=(l=s.next()).done);a=!0){var u=l.value;"field-cell"!==u&&t.classList.remove(u)}}catch(t){o=!0,i=t}finally{try{a||null==s.return||s.return()}finally{if(o)throw i}}t.classList.add("field-cell--".concat(n[e][r]))}else{var f=!0,c=!1,d=void 0;try{for(var y,h=t.classList[Symbol.iterator]();!(f=(y=h.next()).done);f=!0){var v=y.value;"field-cell"!==v&&t.classList.remove(v)}}catch(t){c=!0,d=t}finally{try{f||null==h.return||h.return()}finally{if(c)throw d}}}})})}o.addEventListener("click",function(){a.gameStarted?(a.restart(),i.textContent=a.getScore(),l.style.display="none",s.style.display="none",f()):(a.start(),f(),u.hidden=!0,o.textContent="restart",o.classList.remove("start"),o.classList.add("restart"),l.style.display="none",s.style.display="none")}),document.addEventListener("keydown",function(t){if(!1===a.gameStarted){t.preventDefault();return}"ArrowLeft"===t.key&&(a.moveLeft(),f()),"ArrowRight"===t.key&&(a.moveRight(),f()),"ArrowUp"===t.key&&(a.moveUp(),f()),"ArrowDown"===t.key&&(a.moveDown(),f()),"win"===a.getStatus()&&(t.preventDefault(),s.style.display="block"),"idle"===a.getStatus()&&t.preventDefault(),"lose"===a.getStatus()&&(t.preventDefault(),l.style.display="block"),i.textContent=a.getScore()})}();
//# sourceMappingURL=index.5da060e3.js.map
